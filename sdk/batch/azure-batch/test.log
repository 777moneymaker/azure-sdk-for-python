============================= test session starts =============================
platform win32 -- Python 3.8.10, pytest-7.4.0, pluggy-1.2.0
rootdir: C:\Users\hoppe\work\sandbox\azure-sdk-for-python
configfile: setup.cfg
plugins: asyncio-0.21.1, cov-4.1.0
asyncio: mode=strict
collected 1 item

tests\test_batch.py F                                                    [100%]

================================== FAILURES ===================================
_________________________ TestBatch.test_batch_tasks __________________________

self = <test_batch.TestBatch object at 0x0000014C77F3EEB0>
kwargs = {'__aggregate_cache_key': (('JobPreparer',), (('AccountPreparer',), ('ResourceGroupPreparer', 'resource_group', ''))),... id='batch71d31cdf'), 'credential': <azure.core.credentials.AzureNamedKeyCredential object at 0x0000014C77F2BF10>, ...}
client = <azure.batch._patch.BatchClient object at 0x0000014C77F2B8B0>

    async def wrapper(self, **kwargs):
        client = create_sharedkey_client(**kwargs)
        try:
            await test_func(self, client, **kwargs)
        except Exception as err:
>           raise err

tests\decorators.py:161: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tests\decorators.py:159: in wrapper
    await test_func(self, client, **kwargs)
tests\decorators.py:103: in record_wrap
    test_variables = await test_func(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <test_batch.TestBatch object at 0x0000014C77F3EEB0>
client = <azure.batch._patch.BatchClient object at 0x0000014C77F2B8B0>
kwargs = {'__aggregate_cache_key': (('JobPreparer',), (('AccountPreparer',), ('ResourceGroupPreparer', 'resource_group', ''))),...redential': <azure.core.credentials.AzureNamedKeyCredential object at 0x0000014C77F2BF10>, 'location': 'eastasia', ...}
batch_job = FakeResource(name='batch71d31cdf', id='batch71d31cdf')
exit_conditions = {'exitCodes': [{'code': 1, 'exitOptions': {'jobAction': <JobAction.TERMINATE: 'terminate'>}}], 'exitCodeRanges': [{'st... 4, 'exitOptions': {'jobAction': <JobAction.DISABLE: 'disable'>}}], 'default': {'jobAction': <JobAction.NONE: 'none'>}}
task_param = {'id': 'batch_task6_71d31cdf', 'commandLine': 'cmd /c "echo hello world"', 'userIdentity': {'username': 'task-user'}}
task = {'id': 'mytask732', 'commandLine': 'sleep 1', 'resourceFiles': [{'httpUrl': 'https://mystorageaccount.blob.core.window...8'}, {'httpUrl': 'https://mystorageaccount.blob.core.windows.net/files/resourceFile99', 'filePath': 'resourceFile99'}]}

    @ResourceGroupPreparer(location=AZURE_LOCATION)
    @AccountPreparer(location=AZURE_LOCATION, batch_environment=BATCH_ENVIRONMENT)
    @JobPreparer(on_task_failure=models.OnTaskFailure.perform_exit_options_job_action)
    @client_setup(BatchClient)
    @recorded_by_proxy_async
    async def test_batch_tasks(self, client: BatchClient, **kwargs):
        batch_job = kwargs.pop("batch_job")
    
        # Test Create Task with Auto Complete
        exit_conditions = models.ExitConditions(
            exit_codes=[
                models.ExitCodeMapping(
                    code=1,
                    exit_options=models.ExitOptions(
                        job_action=models.JobAction.terminate
                    ),
                )
            ],
            exit_code_ranges=[
                models.ExitCodeRangeMapping(
                    start=2,
                    end=4,
                    exit_options=models.ExitOptions(
                        job_action=models.JobAction.disable
                    ),
                )
            ],
            default=models.ExitOptions(job_action=models.JobAction.none),
        )
        task_param = models.BatchTaskCreateOptions(
            id=self.get_resource_name("batch_task1_"),
            command_line='cmd /c "echo hello world"',
            exit_conditions=exit_conditions,
        )
        try:
            await async_wrapper(client.create_task(batch_job.id, task_param))
        except azure.core.exceptions.HttpResponseError as e:
            message = "{}: ".format(e.error.code, e.error.message)
            for v in e.model.values:
                message += "\n{}: {}".format(v.key, v.value)
            raise Exception(message)
        task = await async_wrapper(client.get_task(batch_job.id, task_param.id))
        assert isinstance(task, models.BatchTask)
        assert task.exit_conditions.default.job_action == models.JobAction.none
        assert task.exit_conditions.exit_codes[0].code == 1
        assert (
            task.exit_conditions.exit_codes[0].exit_options.job_action
            == models.JobAction.terminate
        )
    
        # Test Create Task with Output Files
        container_url = "https://test.blob.core.windows.net:443/test-container"
        outputs = [
            models.OutputFile(
                file_pattern="../stdout.txt",
                destination=models.OutputFileDestination(
                    container=models.OutputFileBlobContainerDestination(
                        container_url=container_url, path="taskLogs/output.txt"
                    )
                ),
                upload_options=models.OutputFileUploadOptions(
                    upload_condition=models.OutputFileUploadCondition.task_completion
                ),
            ),
            models.OutputFile(
                file_pattern="../stderr.txt",
                destination=models.OutputFileDestination(
                    container=models.OutputFileBlobContainerDestination(
                        container_url=container_url, path="taskLogs/error.txt"
                    )
                ),
                upload_options=models.OutputFileUploadOptions(
                    upload_condition=models.OutputFileUploadCondition.task_failure
                ),
            ),
        ]
        task_param = models.BatchTaskCreateOptions(
            id=self.get_resource_name("batch_task2_"),
            command_line='cmd /c "echo hello world"',
            output_files=outputs,
        )
        await async_wrapper(client.create_task(batch_job.id, task_param))
        task = await async_wrapper(client.get_task(batch_job.id, task_param.id))
        assert isinstance(task, models.BatchTask)
        assert len(task.output_files) == 2
    
        # Test Create Task with Auto User
        auto_user = models.AutoUserSpecification(
            scope=models.AutoUserScope.task, elevation_level=models.ElevationLevel.admin
        )
        task_param = models.BatchTaskCreateOptions(
            id=self.get_resource_name("batch_task3_"),
            command_line='cmd /c "echo hello world"',
            user_identity=models.UserIdentity(auto_user=auto_user),
        )
        await async_wrapper(client.create_task(batch_job.id, task_param))
        task = await async_wrapper(client.get_task(batch_job.id, task_param.id))
        assert isinstance(task, models.BatchTask)
        assert task.user_identity.auto_user.scope == models.AutoUserScope.task
        assert (
            task.user_identity.auto_user.elevation_level == models.ElevationLevel.admin
        )
    
        # Test Create Task with Token Settings
        task_param = models.BatchTaskCreateOptions(
            id=self.get_resource_name("batch_task4_"),
            command_line='cmd /c "echo hello world"',
            authentication_token_settings=models.AuthenticationTokenSettings(
                access=[models.AccessScope.job]
            ),
        )
        await async_wrapper(client.create_task(batch_job.id, task_param))
        task = await async_wrapper(client.get_task(batch_job.id, task_param.id))
        assert isinstance(task, models.BatchTask)
        assert task.authentication_token_settings.access[0] == models.AccessScope.job
    
        # Test Create Task with Container Settings
        task_param = models.BatchTaskCreateOptions(
            id=self.get_resource_name("batch_task5_"),
            command_line='cmd /c "echo hello world"',
            container_settings=models.TaskContainerSettings(
                image_name="windows_container:latest",
                registry=models.ContainerRegistry(
                    username="username", password="password"
                ),
            ),
        )
        await async_wrapper(client.create_task(batch_job.id, task_param))
        task = await async_wrapper(client.get_task(batch_job.id, task_param.id))
        assert isinstance(task, models.BatchTask)
        assert task.container_settings.image_name == "windows_container:latest"
        assert task.container_settings.registry.username == "username"
    
        # Test Create Task with Run-As-User
        task_param = models.BatchTaskCreateOptions(
            id=self.get_resource_name("batch_task6_"),
            command_line='cmd /c "echo hello world"',
            user_identity=models.UserIdentity(username="task-user"),
        )
        await async_wrapper(client.create_task(batch_job.id, task_param))
        task = await async_wrapper(client.get_task(batch_job.id, task_param.id))
        assert isinstance(task, models.BatchTask)
        assert task.user_identity.username == "task-user"
    
        # Test Add Task Collection
        tasks = []
        for i in range(7, 10):
            tasks.append(
                models.BatchTaskCreateOptions(
                    id=self.get_resource_name("batch_task{}_".format(i)),
                    command_line='cmd /c "echo hello world"',
                )
            )
        result = await async_wrapper(
            client.create_task_collection(batch_job.id, collection=tasks)
        )
        assert isinstance(result, models.TaskAddCollectionResult)
        assert len(result.value) == 3
        assert result.value[0].status == models.TaskAddStatus.success
    
        # Test List Tasks
        tasks = list(await async_wrapper(client.list_tasks(batch_job.id)))
        assert len(tasks) == 9
    
        # Test Count Tasks
        task_results = await async_wrapper(client.get_job_task_counts(batch_job.id))
        assert isinstance(task_results, models.TaskCountsResult)
        assert task_results.task_counts.completed == 0
        assert task_results.task_counts.succeeded == 0
    
        # Test Terminate Task
        response = await async_wrapper(
            client.terminate_task(batch_job.id, task_param.id)
        )
        assert response is None
        task = await async_wrapper(client.get_task(batch_job.id, task_param.id))
        assert task.state == models.TaskState.completed
    
        # Test Reactivate Task
        response = await async_wrapper(
            client.reactivate_task(batch_job.id, task_param.id)
        )
        assert response is None
        task = await async_wrapper(client.get_task(batch_job.id, task_param.id))
        assert task.state == models.TaskState.active
    
        # Test Update Task
        response = await async_wrapper(
            client.replace_task(
                job_id=batch_job.id,
                task_id=task_param.id,
                body=models.BatchTask(
                    constraints=models.TaskConstraints(max_task_retry_count=1)
                ),
            )
        )
        assert response is None
    
        # Test Get Subtasks
        # TODO: Test with actual subtasks
        subtasks = await async_wrapper(
            client.list_sub_tasks(batch_job.id, task_param.id)
        )
        assert isinstance(subtasks, models.BatchTaskListSubtasksResult)
        assert subtasks.value == []
    
        # Test Delete Task
        response = await async_wrapper(client.delete_task(batch_job.id, task_param.id))
        assert response is None
    
        # Test Bulk Add Task Failure
        task_id = "mytask"
        tasks_to_add = []
        resource_files = []
        for i in range(10000):
            resource_file = models.ResourceFile(
                http_url="https://mystorageaccount.blob.core.windows.net/files/resourceFile{}".format(
                    str(i)
                ),
                file_path="resourceFile{}".format(str(i)),
            )
            resource_files.append(resource_file)
        task = models.BatchTaskCreateOptions(
            id=task_id, command_line="sleep 1", resource_files=resource_files
        )
        tasks_to_add.append(task)
        await self.assertCreateTasksError(
            "RequestBodyTooLarge",
            client.create_task_collection,
            batch_job.id,
            tasks_to_add,
        )
        await self.assertCreateTasksError(
            "RequestBodyTooLarge",
            client.create_task_collection,
            batch_job.id,
            tasks_to_add,
            concurrencies=3,
        )
    
        # Test Bulk Add Task Success
        task_id = "mytask"
        tasks_to_add = []
        resource_files = []
        for i in range(100):
            resource_file = models.ResourceFile(
                http_url="https://mystorageaccount.blob.core.windows.net/files/resourceFile"
                + str(i),
                file_path="resourceFile" + str(i),
            )
            resource_files.append(resource_file)
        for i in range(733):
            task = models.BatchTaskCreateOptions(
                id=task_id + str(i),
                command_line="sleep 1",
                resource_files=resource_files,
            )
            tasks_to_add.append(task)
        result = await async_wrapper(
            client.create_task_collection(batch_job.id, tasks_to_add, concurrencies=3)
        )
        assert isinstance(result, models.TaskAddCollectionResult)
>       assert len(result.value) == 733
E       AssertionError: assert 533 == 733
E        +  where 533 = len([{'status': 'Success', 'taskId': 'mytask732', 'eTag': '0x8DBAF6F3F11222B', 'lastModified': '2023-09-07T06:54:13.737527...54:13.7555272Z', 'location': 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/tasks/mytask727'}, ...])
E        +    where [{'status': 'Success', 'taskId': 'mytask732', 'eTag': '0x8DBAF6F3F11222B', 'lastModified': '2023-09-07T06:54:13.737527...54:13.7555272Z', 'location': 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/tasks/mytask727'}, ...] = {'value': [{'status': 'Success', 'taskId': 'mytask732', 'eTag': '0x8DBAF6F3F11222B', 'lastModified': '2023-09-07T06:54...T06:55:27.5537837Z', 'location': 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/tasks/mytask633'}]}.value

tests\test_batch.py:1322: AssertionError
----------------------------- Captured log setup ------------------------------
WARNING  urllib3.connectionpool:connectionpool.py:812 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x0000014C77F3E6D0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')': /Info/Available
WARNING  urllib3.connectionpool:connectionpool.py:812 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x0000014C77F3E280>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')': /Info/Available
WARNING  urllib3.connectionpool:connectionpool.py:812 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x0000014C77F3E1C0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it')': /Info/Available
INFO     root:proxy_startup.py:284 C:\Users\hoppe\work\sandbox\azure-sdk-for-python is calculated repo root
INFO     root:proxy_startup.py:300 Downloading and starting standalone proxy executable...
---------------------------- Captured stdout call -----------------------------
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout: connection_timeout:  300
 300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
connection_timeout:  300
------------------------------ Captured log call ------------------------------
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:511 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/tasks?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'content-type': 'application/json; odata=minimalmetadata'
    'Content-Length': '286'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
A body is sent with the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 201
Response headers:
    'Content-Length': '0'
    'Date': 'Thu, 07 Sep 2023 06:53:46 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'ETag': '0x8DBAF6F2F67300B'
    'Last-Modified': 'Thu, 07 Sep 2023 06:53:47 GMT'
    'Location': 'REDACTED'
    'DataServiceId': 'REDACTED'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': '7ef214b0-d5e1-4074-8b03-c54f5cb21089'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:514 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/tasks/batch_task1_71d31cdf?api-version=REDACTED'
Request method: 'GET'
Request headers:
    'Accept': 'application/json'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
No body was attached to the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 200
Response headers:
    'Content-Type': 'application/json; odata=minimalmetadata'
    'Date': 'Thu, 07 Sep 2023 06:53:47 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'ETag': '0x8DBAF6F2F67300B'
    'Last-Modified': 'Thu, 07 Sep 2023 06:53:47 GMT'
    'Transfer-Encoding': 'chunked'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': '4e622e1a-9e42-49f9-9786-b2d18d24595c'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:511 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/tasks?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'content-type': 'application/json; odata=minimalmetadata'
    'Content-Length': '541'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
A body is sent with the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 201
Response headers:
    'Content-Length': '0'
    'Date': 'Thu, 07 Sep 2023 06:53:47 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'ETag': '0x8DBAF6F2F9B08E9'
    'Last-Modified': 'Thu, 07 Sep 2023 06:53:47 GMT'
    'Location': 'REDACTED'
    'DataServiceId': 'REDACTED'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': '4d6b15ee-61a0-4d8e-ba11-ada58582ce4a'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:514 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/tasks/batch_task2_71d31cdf?api-version=REDACTED'
Request method: 'GET'
Request headers:
    'Accept': 'application/json'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
No body was attached to the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 200
Response headers:
    'Content-Type': 'application/json; odata=minimalmetadata'
    'Date': 'Thu, 07 Sep 2023 06:53:47 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'ETag': '0x8DBAF6F2F9B08E9'
    'Last-Modified': 'Thu, 07 Sep 2023 06:53:47 GMT'
    'Transfer-Encoding': 'chunked'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': '141bf797-ab0a-4817-a845-c2dad2da5a0e'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:511 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/tasks?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'content-type': 'application/json; odata=minimalmetadata'
    'Content-Length': '152'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
A body is sent with the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 201
Response headers:
    'Content-Length': '0'
    'Date': 'Thu, 07 Sep 2023 06:53:47 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'ETag': '0x8DBAF6F2FCF365C'
    'Last-Modified': 'Thu, 07 Sep 2023 06:53:48 GMT'
    'Location': 'REDACTED'
    'DataServiceId': 'REDACTED'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': 'f54e9e2d-390f-4360-a760-7d6dba4cd7b9'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:514 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/tasks/batch_task3_71d31cdf?api-version=REDACTED'
Request method: 'GET'
Request headers:
    'Accept': 'application/json'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
No body was attached to the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 200
Response headers:
    'Content-Type': 'application/json; odata=minimalmetadata'
    'Date': 'Thu, 07 Sep 2023 06:53:47 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'ETag': '0x8DBAF6F2FCF365C'
    'Last-Modified': 'Thu, 07 Sep 2023 06:53:48 GMT'
    'Transfer-Encoding': 'chunked'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': 'd16e91e5-9189-4010-99e4-5223e6c3c40d'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:511 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/tasks?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'content-type': 'application/json; odata=minimalmetadata'
    'Content-Length': '128'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
A body is sent with the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 201
Response headers:
    'Content-Length': '0'
    'Date': 'Thu, 07 Sep 2023 06:53:47 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'ETag': '0x8DBAF6F2FF8425D'
    'Last-Modified': 'Thu, 07 Sep 2023 06:53:48 GMT'
    'Location': 'REDACTED'
    'DataServiceId': 'REDACTED'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': '5e17e16c-cd90-4533-86ed-0879042f406d'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:514 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/tasks/batch_task4_71d31cdf?api-version=REDACTED'
Request method: 'GET'
Request headers:
    'Accept': 'application/json'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
No body was attached to the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 200
Response headers:
    'Content-Type': 'application/json; odata=minimalmetadata'
    'Date': 'Thu, 07 Sep 2023 06:53:47 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'ETag': '0x8DBAF6F2FF8425D'
    'Last-Modified': 'Thu, 07 Sep 2023 06:53:48 GMT'
    'Transfer-Encoding': 'chunked'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': 'ed365183-2e27-4026-b4f1-c8abd6d77236'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:511 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/tasks?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'content-type': 'application/json; odata=minimalmetadata'
    'Content-Length': '202'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
A body is sent with the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 201
Response headers:
    'Content-Length': '0'
    'Date': 'Thu, 07 Sep 2023 06:53:48 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'ETag': '0x8DBAF6F302201D4'
    'Last-Modified': 'Thu, 07 Sep 2023 06:53:48 GMT'
    'Location': 'REDACTED'
    'DataServiceId': 'REDACTED'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': '2ed27751-fa39-49ca-aaf8-add8d6c24410'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:514 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/tasks/batch_task5_71d31cdf?api-version=REDACTED'
Request method: 'GET'
Request headers:
    'Accept': 'application/json'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
No body was attached to the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 200
Response headers:
    'Content-Type': 'application/json; odata=minimalmetadata'
    'Date': 'Thu, 07 Sep 2023 06:53:48 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'ETag': '0x8DBAF6F302201D4'
    'Last-Modified': 'Thu, 07 Sep 2023 06:53:48 GMT'
    'Transfer-Encoding': 'chunked'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': 'f8a512f5-a798-49b6-b325-ca20ccc147ca'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:511 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/tasks?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'content-type': 'application/json; odata=minimalmetadata'
    'Content-Length': '119'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
A body is sent with the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 201
Response headers:
    'Content-Length': '0'
    'Date': 'Thu, 07 Sep 2023 06:53:48 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'ETag': '0x8DBAF6F304A8109'
    'Last-Modified': 'Thu, 07 Sep 2023 06:53:48 GMT'
    'Location': 'REDACTED'
    'DataServiceId': 'REDACTED'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': '982e750c-3440-4a1f-95bb-a8546b8c71a5'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:514 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/tasks/batch_task6_71d31cdf?api-version=REDACTED'
Request method: 'GET'
Request headers:
    'Accept': 'application/json'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
No body was attached to the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 200
Response headers:
    'Content-Type': 'application/json; odata=minimalmetadata'
    'Date': 'Thu, 07 Sep 2023 06:53:48 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'ETag': '0x8DBAF6F304A8109'
    'Last-Modified': 'Thu, 07 Sep 2023 06:53:48 GMT'
    'Transfer-Encoding': 'chunked'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': 'c274659c-373c-4734-84e7-efff8368fe8f'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:511 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/addtaskcollection?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'content-type': 'application/json; odata=minimalmetadata'
    'Content-Length': '245'
    'Accept': 'application/json'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
A body is sent with the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 200
Response headers:
    'Content-Type': 'application/json; odata=minimalmetadata'
    'Date': 'Thu, 07 Sep 2023 06:53:48 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'Transfer-Encoding': 'chunked'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': '82e98861-91cb-4a0b-9b31-ef286d177a0c'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:514 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/tasks?api-version=REDACTED'
Request method: 'GET'
Request headers:
    'Accept': 'application/json'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
No body was attached to the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 200
Response headers:
    'Content-Type': 'application/json; odata=minimalmetadata'
    'Date': 'Thu, 07 Sep 2023 06:53:48 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'Transfer-Encoding': 'chunked'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': 'fa1a52c3-53fc-4153-8d2f-1a66a6a4ef37'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:514 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/taskcounts?api-version=REDACTED'
Request method: 'GET'
Request headers:
    'Accept': 'application/json'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
No body was attached to the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 200
Response headers:
    'Content-Type': 'application/json; odata=minimalmetadata'
    'Date': 'Thu, 07 Sep 2023 06:53:51 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'Transfer-Encoding': 'chunked'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': 'cbbc9d0b-420d-4d62-8752-73bf0e1051ea'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:514 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/tasks/batch_task6_71d31cdf/terminate?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
No body was attached to the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 204
Response headers:
    'Content-Length': '0'
    'Date': 'Thu, 07 Sep 2023 06:53:51 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'ETag': '0x8DBAF6F31F24E21'
    'Last-Modified': 'Thu, 07 Sep 2023 06:53:51 GMT'
    'DataServiceId': 'REDACTED'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': 'e287cadb-71bb-40e9-a8e6-5491481c1d8e'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:514 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/tasks/batch_task6_71d31cdf?api-version=REDACTED'
Request method: 'GET'
Request headers:
    'Accept': 'application/json'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
No body was attached to the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 200
Response headers:
    'Content-Type': 'application/json; odata=minimalmetadata'
    'Date': 'Thu, 07 Sep 2023 06:53:51 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'ETag': '0x8DBAF6F31F24E21'
    'Last-Modified': 'Thu, 07 Sep 2023 06:53:51 GMT'
    'Transfer-Encoding': 'chunked'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': '3b1ca9fe-6c7c-482d-872a-20f14d5adfd5'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:514 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/tasks/batch_task6_71d31cdf/reactivate?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
No body was attached to the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 204
Response headers:
    'Content-Length': '0'
    'Date': 'Thu, 07 Sep 2023 06:53:51 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'ETag': '0x8DBAF6F322087C9'
    'Last-Modified': 'Thu, 07 Sep 2023 06:53:52 GMT'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': 'a0b3f9ca-7734-4d9f-ab07-db2416c882b1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:514 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/tasks/batch_task6_71d31cdf?api-version=REDACTED'
Request method: 'GET'
Request headers:
    'Accept': 'application/json'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
No body was attached to the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 200
Response headers:
    'Content-Type': 'application/json; odata=minimalmetadata'
    'Date': 'Thu, 07 Sep 2023 06:53:51 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'ETag': '0x8DBAF6F322087C9'
    'Last-Modified': 'Thu, 07 Sep 2023 06:53:52 GMT'
    'Transfer-Encoding': 'chunked'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': '45c8aa29-33c2-4de8-8e72-aa631e0151c1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:511 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/tasks/batch_task6_71d31cdf?api-version=REDACTED'
Request method: 'PUT'
Request headers:
    'content-type': 'application/json; odata=minimalmetadata'
    'Content-Length': '41'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
A body is sent with the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 200
Response headers:
    'Content-Length': '0'
    'Date': 'Thu, 07 Sep 2023 06:53:51 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'ETag': '0x8DBAF6F324AF37E'
    'Last-Modified': 'Thu, 07 Sep 2023 06:53:52 GMT'
    'DataServiceId': 'REDACTED'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': 'c7ece736-e267-4a18-8faf-f4ffa57d16e9'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:514 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/tasks/batch_task6_71d31cdf/subtasksinfo?api-version=REDACTED'
Request method: 'GET'
Request headers:
    'Accept': 'application/json'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
No body was attached to the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 200
Response headers:
    'Content-Type': 'application/json; odata=minimalmetadata'
    'Date': 'Thu, 07 Sep 2023 06:53:51 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'Transfer-Encoding': 'chunked'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': 'f8befbcd-adea-4cb2-afca-36c14fb61023'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:514 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/tasks/batch_task6_71d31cdf?api-version=REDACTED'
Request method: 'DELETE'
Request headers:
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
No body was attached to the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 200
Response headers:
    'Content-Length': '0'
    'Date': 'Thu, 07 Sep 2023 06:53:51 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': 'e0fd5eb4-0253-49e7-b3f9-f833f1fc2d3a'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:511 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/addtaskcollection?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'content-type': 'application/json; odata=minimalmetadata'
    'Content-Length': '1177854'
    'Accept': 'application/json'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
A body is sent with the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 413
Response headers:
    'Content-Length': '413'
    'Content-Type': 'application/json; odata=minimalmetadata'
    'Date': 'Thu, 07 Sep 2023 06:53:52 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': '4da6e047-812b-4f9a-8b42-105d2cd23013'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
ERROR    azure.batch._operations._patch:_patch.py:497 Failed to add task with ID mytask due to the body exceeding the maximum request size
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:511 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/addtaskcollection?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'content-type': 'application/json; odata=minimalmetadata'
    'Content-Length': '1177854'
    'Accept': 'application/json'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
A body is sent with the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 413
Response headers:
    'Content-Length': '413'
    'Content-Type': 'application/json; odata=minimalmetadata'
    'Date': 'Thu, 07 Sep 2023 06:53:57 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': '42cda791-3298-4605-88ff-dcacbaab8382'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
ERROR    azure.batch._operations._patch:_patch.py:497 Failed to add task with ID mytask due to the body exceeding the maximum request size
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:511 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/addtaskcollection?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'content-type': 'application/json; odata=minimalmetadata'
    'Content-Length': '1144611'
    'Accept': 'application/json'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
A body is sent with the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:511 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/addtaskcollection?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'content-type': 'application/json; odata=minimalmetadata'
    'Content-Length': '1144611'
    'Accept': 'application/json'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
A body is sent with the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:511 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/addtaskcollection?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'content-type': 'application/json; odata=minimalmetadata'
    'Content-Length': '1144611'
    'Accept': 'application/json'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
A body is sent with the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 404
Response headers:
    'Content-Type': 'application/json;'
    'Date': 'Sun, 08 Oct 2023 08:37:25 GMT'
    'Server': 'Kestrel'
    'Transfer-Encoding': 'chunked'
    'x-request-mismatch': 'REDACTED'
    'x-request-mismatch-error': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 413
Response headers:
    'Content-Length': '413'
    'Content-Type': 'application/json; odata=minimalmetadata'
    'Date': 'Thu, 07 Sep 2023 06:54:05 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': 'd90f6288-2515-427a-afd0-f68bd43682fe'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.batch._operations._patch:_patch.py:511 Amount of tasks per request reduced from 100 to 50 due to the request body being too large
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 404
Response headers:
    'Content-Type': 'application/json;'
    'Date': 'Sun, 08 Oct 2023 08:37:25 GMT'
    'Server': 'Kestrel'
    'Transfer-Encoding': 'chunked'
    'x-request-mismatch': 'REDACTED'
    'x-request-mismatch-error': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:511 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/addtaskcollection?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'content-type': 'application/json; odata=minimalmetadata'
    'Content-Length': '572311'
    'Accept': 'application/json'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
A body is sent with the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 200
Response headers:
    'Content-Type': 'application/json; odata=minimalmetadata'
    'Date': 'Thu, 07 Sep 2023 06:54:13 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'Transfer-Encoding': 'chunked'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': '7386f1e3-340b-46df-8472-1babfb8d248e'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:511 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/addtaskcollection?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'content-type': 'application/json; odata=minimalmetadata'
    'Content-Length': '572311'
    'Accept': 'application/json'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
A body is sent with the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 200
Response headers:
    'Content-Type': 'application/json; odata=minimalmetadata'
    'Date': 'Thu, 07 Sep 2023 06:55:01 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'Transfer-Encoding': 'chunked'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': '8c7c22e7-8b5c-4cbd-9c1f-23c532c2190e'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:511 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/addtaskcollection?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'content-type': 'application/json; odata=minimalmetadata'
    'Content-Length': '572311'
    'Accept': 'application/json'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
A body is sent with the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 200
Response headers:
    'Content-Type': 'application/json; odata=minimalmetadata'
    'Date': 'Thu, 07 Sep 2023 06:55:03 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'Transfer-Encoding': 'chunked'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': '23c3e991-6447-408e-b9f6-ac32437f9ef5'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:511 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/addtaskcollection?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'content-type': 'application/json; odata=minimalmetadata'
    'Content-Length': '572311'
    'Accept': 'application/json'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
A body is sent with the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 200
Response headers:
    'Content-Type': 'application/json; odata=minimalmetadata'
    'Date': 'Thu, 07 Sep 2023 06:55:07 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'Transfer-Encoding': 'chunked'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': '6205f85d-fefb-4e0a-a252-9f72b793004f'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:511 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/addtaskcollection?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'content-type': 'application/json; odata=minimalmetadata'
    'Content-Length': '572311'
    'Accept': 'application/json'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
A body is sent with the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 200
Response headers:
    'Content-Type': 'application/json; odata=minimalmetadata'
    'Date': 'Thu, 07 Sep 2023 06:55:10 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'Transfer-Encoding': 'chunked'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': 'e7fffbe3-4c4b-4a39-855d-5042c9143772'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:511 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/addtaskcollection?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'content-type': 'application/json; odata=minimalmetadata'
    'Content-Length': '572311'
    'Accept': 'application/json'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
A body is sent with the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 200
Response headers:
    'Content-Type': 'application/json; odata=minimalmetadata'
    'Date': 'Thu, 07 Sep 2023 06:55:13 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'Transfer-Encoding': 'chunked'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': 'b635ff97-c903-4454-815a-882e0a6acf3a'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:511 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/addtaskcollection?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'content-type': 'application/json; odata=minimalmetadata'
    'Content-Length': '572311'
    'Accept': 'application/json'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
A body is sent with the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 200
Response headers:
    'Content-Type': 'application/json; odata=minimalmetadata'
    'Date': 'Thu, 07 Sep 2023 06:55:15 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'Transfer-Encoding': 'chunked'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': '78e8e4c1-f616-4468-8147-76ee7a6d73e0'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:511 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/addtaskcollection?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'content-type': 'application/json; odata=minimalmetadata'
    'Content-Length': '572294'
    'Accept': 'application/json'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
A body is sent with the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 200
Response headers:
    'Content-Type': 'application/json; odata=minimalmetadata'
    'Date': 'Thu, 07 Sep 2023 06:55:17 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'Transfer-Encoding': 'chunked'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': 'f4117240-e444-40eb-a8fa-92f198020fe4'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:511 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/addtaskcollection?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'content-type': 'application/json; odata=minimalmetadata'
    'Content-Length': '572261'
    'Accept': 'application/json'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
A body is sent with the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 200
Response headers:
    'Content-Type': 'application/json; odata=minimalmetadata'
    'Date': 'Thu, 07 Sep 2023 06:55:21 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'Transfer-Encoding': 'chunked'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': 'c1c9be5d-5e8f-4ce5-840b-8aab4b9a3c5b'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:511 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/addtaskcollection?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'content-type': 'application/json; odata=minimalmetadata'
    'Content-Length': '572268'
    'Accept': 'application/json'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
A body is sent with the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 200
Response headers:
    'Content-Type': 'application/json; odata=minimalmetadata'
    'Date': 'Thu, 07 Sep 2023 06:55:24 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'Transfer-Encoding': 'chunked'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': '9c55382c-6393-4ae8-b322-e8b9e7a1b9d0'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:511 Request URL: 'https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/addtaskcollection?api-version=REDACTED'
Request method: 'POST'
Request headers:
    'content-type': 'application/json; odata=minimalmetadata'
    'Content-Length': '377729'
    'Accept': 'application/json'
    'client-request-id': 'REDACTED'
    'User-Agent': 'azsdk-python-batch/14.0.0b Python/3.8.10 (Windows-10-10.0.22621-SP0)'
    'ocp-date': 'REDACTED'
    'Authorization': 'REDACTED'
A body is sent with the request
INFO     azure.core.pipeline.policies.http_logging_policy:_universal.py:550 Response status: 200
Response headers:
    'Content-Type': 'application/json; odata=minimalmetadata'
    'Date': 'Thu, 07 Sep 2023 06:55:27 GMT'
    'Server': 'Microsoft-HTTPAPI/2.0'
    'Transfer-Encoding': 'chunked'
    'DataServiceVersion': 'REDACTED'
    'Request-Id': '3db53a52-4fec-427c-a500-2f9054a75cda'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
---------------------------- Captured log teardown ----------------------------
INFO     root:proxy_startup.py:334 Stopping the test proxy tool...
============================== warnings summary ===============================
sdk/batch/azure-batch/tests/test_batch.py::TestBatch::test_batch_tasks
  c:\users\hoppe\work\sandbox\azure-sdk-for-python\env\lib\site-packages\_pytest\threadexception.py:73: PytestUnhandledThreadExceptionWarning: Exception in thread Thread-5
  
  Traceback (most recent call last):
    File "c:\users\hoppe\work\sandbox\azure-sdk-for-python\sdk\batch\azure-batch\azure\batch\_operations\_patch.py", line 480, in _bulk_add_tasks
      create_task_collection_response = self._original_create_task_collection(
    File "c:\users\hoppe\work\sandbox\azure-sdk-for-python\env\lib\site-packages\azure\core\tracing\decorator.py", line 76, in wrapper_use_tracer
      return func(*args, **kwargs)
    File "c:\users\hoppe\work\sandbox\azure-sdk-for-python\sdk\batch\azure-batch\azure\batch\_operations\_operations.py", line 8176, in create_task_collection
      map_error(status_code=response.status_code, response=response, error_map=error_map)
    File "c:\users\hoppe\work\sandbox\azure-sdk-for-python\env\lib\site-packages\azure\core\exceptions.py", line 112, in map_error
      raise error
  azure.core.exceptions.ResourceNotFoundError: Operation returned an invalid status 'Not Found'
  Content: {"Message":"Unable to find a record for the request POST https://batch71d31cdf.eastasia.batch.azure.com/jobs/batch71d31cdf/addtaskcollection?api-version=2023-05-01.17.0\r\nHeader differences:\r\nBody differences:\r\nRequest and record bodies do not match at index 23:\r\n     request: \u0022d\u0022:\u0022mytask632\u0022,\u0022commandLine\u0022:\u0022\u0022\r\n     record:  \u0022d\u0022:\u0022mytask732\u0022,\u0022commandLine\u0022:\u0022\u0022\r\n","Status":"NotFound"}
  
  During handling of the above exception, another exception occurred:
  
  Traceback (most recent call last):
    File "C:\Users\hoppe\AppData\Local\Programs\Python\Python38\lib\threading.py", line 932, in _bootstrap_inner
      self.run()
    File "C:\Users\hoppe\AppData\Local\Programs\Python\Python38\lib\threading.py", line 870, in run
      self._target(*self._args, **self._kwargs)
    File "c:\users\hoppe\work\sandbox\azure-sdk-for-python\sdk\batch\azure-batch\azure\batch\_operations\_patch.py", line 578, in task_collection_thread_handler
      self._bulk_add_tasks(results_queue, chunk_tasks_to_add)
    File "c:\users\hoppe\work\sandbox\azure-sdk-for-python\sdk\batch\azure-batch\azure\batch\_operations\_patch.py", line 489, in _bulk_add_tasks
      if e.error.code == "RequestBodyTooLarge":  # pylint: disable=no-member
  AttributeError: 'NoneType' object has no attribute 'code'
  
    warnings.warn(pytest.PytestUnhandledThreadExceptionWarning(msg))

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ===========================
FAILED tests\test_batch.py::TestBatch::test_batch_tasks - AssertionError: ass...
======================== 1 failed, 1 warning in 23.41s ========================
